<div id="appMenu" class="h-100">
  <div id="sideBar" class="h-100 pt-2" *ngIf="!isEmptyProject">
    <!--- Sidebar menu -->
    <div class="sidebar-menu pl-2 pr-2"
      [ngClass]="isTablet?['d-flex', 'flex-column', 'justify-content-between', 'mh-100', 'h-100']:''">
      <div *ngIf="moduleProjectDefaultModel" [ngClass]="{'d-none': !isCompletionsLink}">
        <ul class="menu-list list-unstyled" id="menuSideMenu">
          <li class="menu-dashboard" *ngIf="!isTablet || (isTablet && !isOffline)">
            <a routerLinkActive="active"
              [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'dashboard']"
              [routerLinkActiveOptions]="{exact: true}" (click)="closeSideMenu()"
              style="text-align: center">
              <i class="fas fa-tachometer-alt mr-2"></i> <span>Dashboard</span>
            </a>
          </li>

          <hr class="mt-2 mb-2" *ngIf="!isTablet || (isTablet && !isOffline)" />

          <li class="menu-title pb-1 text-center">Completions</li>

          <li *ngIf="!isTablet">
            <a data-toggle="collapse" href="#collapseITR" role="button" aria-expanded="false"
              aria-controls="collapseITR" [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>RECORD</span>
              <i class="fas fa-angle-up float-right mt-1"></i>
              <i class="fas fa-angle-down float-right mt-1"></i>
            </a>

            <ul class="collapse list-unstyled" id="collapseITR" data-parent="#menuSideMenu">
              <li>
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'itr-admin']"
                  [routerLinkActiveOptions]="{exact: true}" #rla9="routerLinkActive"
                  [style.background]="rla9.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                  <span class="ml-4 fonSize-0875">Admin</span>
                </a>
              </li>
              <li>
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'itr-builder']"
                  [routerLinkActiveOptions]="{exact: true}" #rla10="routerLinkActive"
                  [style.background]="rla10.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                  <span class="ml-4 fonSize-0875">Builder</span>
                </a>
              </li>
              <li>
                <a data-toggle="collapse" href="#collapseAllocation" role="button" aria-expanded="false"
                  aria-controls="collapseAllocation" [style.color]="colorTextColour2">
                  <span class="ml-4 fonSize-0875">Allocation</span>
                  <i class="fas fa-angle-up float-right mt-1"></i>
                  <i class="fas fa-angle-down float-right mt-1"></i>
                </a>

                <ul class="collapse list-unstyled" id="collapseAllocation" data-parent="#collapseITR">
                  <li>
                    <a routerLinkActive="active"
                      [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'itr-allocation']"
                      [routerLinkActiveOptions]="{exact: true}" #rla11="routerLinkActive"
                      [style.background]="rla11.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                      <span class="ml-5 fonSize-0875">ITR</span>
                    </a>
                  </li>
                  <li>
                    <a routerLinkActive="active"
                      [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'preservation-allocation']"
                      [routerLinkActiveOptions]="{exact: true}" #rla15="routerLinkActive"
                      [style.background]="rla15.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                      <span class="ml-5 fonSize-0875">Preservation</span>
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a routerLinkActive="active"
              [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'tag-tab']"
              [routerLinkActiveOptions]="{exact: true}" #rla12="routerLinkActive"
              [style.background]="rla12.isActive ? colorHeader : ''" [style.color]="colorTextColour2"
              (click)="closeSideMenu()">
              <i class="far fa-circle mr-2"></i> <span>TAG</span>
            </a>
          </li>

          <li *ngIf="!isTablet">
            <a data-toggle="collapse" href="#collapseChange" role="button" aria-expanded="false"
              aria-controls="collapseChange" [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>CHANGE</span>
              <i class="fas fa-angle-up float-right mt-1"></i>
              <i class="fas fa-angle-down float-right mt-1"></i>
            </a>

            <ul class="collapse list-unstyled" id="collapseChange" data-parent="#menuSideMenu">
              <li>
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'my-change']"
                  [routerLinkActiveOptions]="{exact: true}" #rla14="routerLinkActive"
                  [style.background]="rla14.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                  <span class="ml-4">User Change</span>
                </a>
              </li>
              <li>
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'change-tab']"
                  [routerLinkActiveOptions]="{exact: false}" #rla3="routerLinkActive"
                  [style.background]="rla3.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
                  <span class="ml-4">All Change</span>
                </a>
              </li>
            </ul>
          </li>

          <li>
            <a data-toggle="collapse" href="#collapsePunch" role="button" aria-expanded="false"
              aria-controls="collapsePunch" [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>PUNCH</span>
              <i class="fas fa-angle-up float-right mt-1"></i>
              <i class="fas fa-angle-down float-right mt-1"></i>
            </a>

            <ul class="collapse list-unstyled" id="collapsePunch" data-parent="#menuSideMenu">
              <li *ngIf="onCheckPermission(permissionsViews.PUNCH_TAB_MENU_MY_PUNCH)">
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'my-punch']"
                  [routerLinkActiveOptions]="{exact: true}" #rla13="routerLinkActive"
                  [style.background]="rla13.isActive ? colorHeader : ''" [style.color]="colorTextColour2"
                  (click)="closeSideMenu()">
                  <span class="ml-4">User Punch</span>
                </a>
              </li>
              <li>
                <a routerLinkActive="active"
                  [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'punch-tab']"
                  [routerLinkActiveOptions]="{exact: false}" #rla4="routerLinkActive"
                  [style.background]="rla4.isActive ? colorHeader : ''" [style.color]="colorTextColour2"
                  (click)="closeSideMenu()">
                  <span class="ml-4">All Punch</span>
                </a>
              </li>
            </ul>
          </li>

          <li>
            <a routerLinkActive="active"
              [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'milestones-tab']"
              [routerLinkActiveOptions]="{exact: true}" #rla5="routerLinkActive"
              [style.background]="rla5.isActive ? colorHeader : ''" [style.color]="colorTextColour2"
              (click)="closeSideMenu()">
              <i class="far fa-circle mr-2"></i> <span>MILESTONES</span>
            </a>
          </li>

          <li *ngIf="!isTablet">
            <a [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>JOINT INTEGRITY</span>
            </a>
          </li>

          <li>
            <a routerLinkActive="active"
              [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'preservation-tab']"
              [routerLinkActiveOptions]="{exact: false}" #rla16="routerLinkActive"
              [style.background]="rla16.isActive ? colorHeader : ''" [style.color]="colorTextColour2"
              (click)="closeSideMenu()">
              <i class="far fa-circle mr-2"></i> <span>PRESERVATION</span>
            </a>
          </li>

          <li *ngIf="!isTablet">
            <a routerLinkActive="active"
              [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey,'projects', moduleProjectDefaultModel.projectKey,'progress-tab']"
              [routerLinkActiveOptions]="{exact: true}" #rla6="routerLinkActive"
              [style.background]="rla6.isActive ? colorHeader : ''" [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>PROGRESS</span>
            </a>
          </li>

          <li *ngIf="!isTablet">
            <a [style.color]="colorTextColour2">
              <i class="far fa-circle mr-2"></i> <span>DOCUMENTS</span>
            </a>
          </li>
        </ul>
      </div>

      <div [ngClass]="{'d-none': !isWorkpackLink}">
        <ul class="menu-list list-unstyled">
          <li class="menu-title pb-1">Workpack</li>
        </ul>
      </div>

      <div [ngClass]="{'d-none': !isJointIntegrityLink}">
        <ul class="menu-list list-unstyled">
          <li class="menu-title pb-1">Joint Integrity</li>
        </ul>
      </div>

      <div [ngClass]="{'d-none': !isCommissioningProceduresLink}">
        <ul class="menu-list list-unstyled">
          <li class="menu-title pb-1">Commissioning Procedures</li>
        </ul>
      </div>

      <div class="mb-2">

        <button *ngIf="isTablet && !isOffline" mat-raised-button color="success" [disabled]="!hasValueIDB" class="w-100"
          (click)="onSyncAllTag()" role="button" aria-expanded="true" data-toggle="modal" data-backdrop="static"
          data-keyboard="false" data-target="#confirmModal" aria-controls="syncAllForm">
          <i class="fas fa-sync-alt mr-1"></i>Sync Data
        </button>
      </div>

    </div>
    <!-- Sidebar footer -->
    <div class="sidebar-footer d-flex justify-content-between align-items-center pl-3 pr-3 pt-2 pb-2"
      [style.background]="colorSideBar" *ngIf="!isTablet">
      <!-- show when user is Project Admin-->
      <div class="menu-administrator" *ngIf="!isAdmin && isAdminProject">
        <a
          [routerLink]="['', 'modules', moduleProjectDefaultModel.moduleKey, 'project-settings', moduleProjectDefaultModel.projectKey]">
          <img src="../../../../assets/img/cog-white.png" alt="White Cog">
        </a>
      </div>
      <!-- show when only user is Admin -->
      <div class="menu-administrator" *ngIf="isAdmin">
        <a [matMenuTriggerFor]="menuAdministration" matTooltip="ADMINISTRATOR SETTINGS">
          <img src="../../../../assets/img/cog-white.png" alt="White Cog">
        </a>
        <mat-menu #menuAdministration="matMenu">
          <a [routerLink]="['', 'company-management']" routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: true}">
            <button mat-menu-item>
              <i class="far fa-building mr-2"></i>
              <span>Company Management</span>
            </button>
          </a>

          <a [routerLink]="['', 'user-management']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
            <button mat-menu-item>
              <i class="fas fa-users mr-2"></i>
              <span>User Management</span>
            </button>
          </a>

          <a [routerLink]="['', 'modules', moduleProjectDefaultModel.moduleKey, 'project-management']"
            routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
            <button mat-menu-item>
              <i class="fas fa-briefcase mr-2"></i>
              <span>Project Management</span>
            </button>
          </a>

          <a [routerLink]="['', 'role-management']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
            <button mat-menu-item>
              <i class="fas fa-user-tag mr-2"></i>
              <span>Role Management</span>
            </button>
          </a>
        </mat-menu>
      </div>

      <div *ngIf="moduleProjectDefaultModel && moduleProjectDefaultModel.projectKey">
        <a routerLinkActive="active"
          [routerLink]="['','modules', moduleProjectDefaultModel.moduleKey, 'projects', moduleProjectDefaultModel.projectKey, 'data-tab']"
          [routerLinkActiveOptions]="{exact: true}" matTooltip="DATA ENTRY">
          <img src="../../../../assets/img/db-logo.png" class="img-fluid" />
        </a>
      </div>

      <div *ngIf="moduleProjectDefaultModel && moduleProjectDefaultModel.projectKey">
        <a matTooltip="HAND OVER DOCUMENTS">
          <img src="../../../../assets/img/doc-logo.png" class="img-fluid">
        </a>
      </div>
    </div>
  </div>
</div>

<confirm-modal *ngIf="isSyncAllState" [visible]="isSyncAllState" (confirm)="onSyncAllConfirm($event)"
  [header]="'Confirm'" [content]="'Are you sure you want to sync?'"></confirm-modal>